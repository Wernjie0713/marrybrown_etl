# 30-12 Work Log - Product Mix Investigation (Order Tables)

## Context

Continuing Product Mix discrepancy investigation. LocationPrice + RecipeSummary were added, but large mismatches remain. Next step is to pull Order-related tables to validate order-level pricing, packaging fee logic, and source/category mapping.

## Findings

Tables with data (likely relevant):

- `COM_5013.APP_4_ORDER`
- `COM_5013.APP_4_ORDERITEM`
  - Has `ORDER_SOURCE`, `DELIVERY_TYPE`, `ITEM_CATEGORY`, `BOOL_ISPACKAGE`, `DOUBLE_PRICE`, `DOUBLE_ENTER_PRICE`, etc.
  - Could explain packaging fee qty differences and which lines are considered reportable.

Menu/category mapping:

- `COM_5013.APP_4_MENUPROFILE`
- `COM_5013.APP_4_MENUPROFILEMAPPING`
- `COM_5013.APP_4_MENUMAINCATEGORY`
- `COM_5013.APP_4_MENUSUBCATEGORY`
- `COM_5013.APP_4_MENUITEMMODIFIER`
- `COM_5013.APP_4_MENUITEMOUTOFSTOCK`
  - Likely defines Category/Group Name seen in Excel and can be used to filter out component items.

Package + promo:

- `COM_5013.APP_4_PACKAGE`
- `COM_5013.APP_4_PROMOITEM`
- `COM_5013.APP_4_PROMORULE`
  - May explain bundled items and why component lines appear in API but not Excel.

Price history / scheme:

- `COM_5013.APP_4_PRICELOG` (contains `PRICE_SCHEME_ENUM`)
- `COM_5013.APP_4_PRICECHANGEITEM`
  - Might indicate which price tier the report uses per date/sales type.

Customer price scheme:

- `COM_5013.APP_4_CUSTOMER` (has `PRICE_SCHEME`, `DEFAULT_SALES_TYPE`)
- `COM_5013.APP_4_CUSTOMERTYPE` (has `INT_PRICE_SCHEME`, `DEFAULT_SALES_TYPE`)
  - Could influence which price tier is applied.

Tables confirmed empty in Xilnex:

- `COM_5013.APP_4_PRODUCTDICTIONARYMAPPING`
- `COM_5013.APP_4_COMBOITEM`
- `COM_5013.APP_4_MENUDEPARTMENT`
- `COM_5013.APP_4_CLIENTPRICE`
- `COM_5013.APP_4_CLIENTGROUPPRICE`

## Next Actions

- Add `APP_4_ORDER` and `APP_4_ORDERITEM` to the replica schema list.
- Create migrations for `dbo.com_5013_APP_4_ORDER` and `dbo.com_5013_APP_4_ORDERITEM`.
- Replicate order tables for validation against Product Mix output.
