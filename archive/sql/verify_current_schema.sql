-- Verify CURRENT schema of staging_sales

USE MarryBrown_DW;
GO

PRINT '=== CURRENT staging_sales Schema ===';
PRINT '';
GO

SELECT 
    COLUMN_NAME,
    DATA_TYPE,
    CHARACTER_MAXIMUM_LENGTH,
    IS_NULLABLE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'staging_sales'
    AND TABLE_SCHEMA = 'dbo'
ORDER BY ORDINAL_POSITION;
GO

PRINT '';
PRINT '=== Looking for columns with length < 50 ===';
GO

SELECT 
    COLUMN_NAME,
    DATA_TYPE,
    CHARACTER_MAXIMUM_LENGTH
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'staging_sales'
    AND TABLE_SCHEMA = 'dbo'
    AND CHARACTER_MAXIMUM_LENGTH < 50
    AND CHARACTER_MAXIMUM_LENGTH IS NOT NULL
ORDER BY CHARACTER_MAXIMUM_LENGTH;
GO

